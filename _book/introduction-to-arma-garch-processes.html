<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Introduction to ARMA-GARCH processes | Book: Statistical Finance and Computing</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Introduction to ARMA-GARCH processes | Book: Statistical Finance and Computing" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Introduction to ARMA-GARCH processes | Book: Statistical Finance and Computing" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Abhinav Anand" />


<meta name="date" content="2021-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-financial-time-series.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to basic <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#setup"><i class="fa fa-check"></i><b>2.1</b> Setup</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#basics"><i class="fa fa-check"></i><b>2.2</b> Basics</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#remarks"><i class="fa fa-check"></i><b>2.2.1</b> Remarks</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#pipes"><i class="fa fa-check"></i><b>2.3</b> Pipes</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#data-types-in-r-some-examples"><i class="fa fa-check"></i><b>2.4</b> Data-types in R: Some Examples</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#vectors"><i class="fa fa-check"></i><b>2.4.1</b> Vectors</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#recycling"><i class="fa fa-check"></i><b>2.4.2</b> Recycling</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#note"><i class="fa fa-check"></i><b>2.4.3</b> Note</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#the-c-operator"><i class="fa fa-check"></i><b>2.4.4</b> The <code>c()</code> operator</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#arrays-and-matrices"><i class="fa fa-check"></i><b>2.4.5</b> Arrays and Matrices</a></li>
<li class="chapter" data-level="2.4.6" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#dataframes"><i class="fa fa-check"></i><b>2.4.6</b> Dataframes</a></li>
<li class="chapter" data-level="2.4.7" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#subsetting-dataframes"><i class="fa fa-check"></i><b>2.4.7</b> Subsetting Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#functions"><i class="fa fa-check"></i><b>2.5</b> Functions</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#directory-management"><i class="fa fa-check"></i><b>2.6</b> Directory Management</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-basic-r.html"><a href="introduction-to-basic-r.html#rstudio-projects"><i class="fa fa-check"></i><b>2.7</b> RStudio Projects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html"><i class="fa fa-check"></i><b>3</b> Introduction to financial time series</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#empirical-financial-time-series"><i class="fa fa-check"></i><b>3.2</b> Empirical Financial Time Series</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#returns"><i class="fa fa-check"></i><b>3.3</b> Returns</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#one-period-simple-return"><i class="fa fa-check"></i><b>3.3.1</b> One-Period Simple Return</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#multi-period-simple-return"><i class="fa fa-check"></i><b>3.4</b> Multi-period Simple Return</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#log-returns"><i class="fa fa-check"></i><b>3.4.1</b> Log Returns</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#computational-examples"><i class="fa fa-check"></i><b>3.5</b> Computational Examples</a></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#return-series-for-market-indices"><i class="fa fa-check"></i><b>3.6</b> Return Series for Market Indices</a></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#stationarity-of-time-series"><i class="fa fa-check"></i><b>3.7</b> Stationarity of Time Series</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#stationarity"><i class="fa fa-check"></i><b>3.7.1</b> Stationarity</a></li>
<li class="chapter" data-level="3.7.2" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#trend-stationarity"><i class="fa fa-check"></i><b>3.7.2</b> Trend Stationarity</a></li>
<li class="chapter" data-level="3.7.3" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#unit-roots"><i class="fa fa-check"></i><b>3.7.3</b> Unit Roots</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#distribution-of-returns"><i class="fa fa-check"></i><b>3.8</b> Distribution of Returns</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#summary-statistics-of-empirical-returns"><i class="fa fa-check"></i><b>3.8.1</b> Summary Statistics of Empirical Returns</a></li>
<li class="chapter" data-level="3.8.2" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#histograms-for-returns-for-each-index"><i class="fa fa-check"></i><b>3.8.2</b> Histograms for returns for each index</a></li>
<li class="chapter" data-level="3.8.3" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#skewness-and-kurtosis"><i class="fa fa-check"></i><b>3.8.3</b> Skewness and Kurtosis</a></li>
<li class="chapter" data-level="3.8.4" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#the-jarque-bera-test-for-normality"><i class="fa fa-check"></i><b>3.8.4</b> The Jarque-Bera Test for Normality</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#stylized-facts"><i class="fa fa-check"></i><b>3.9</b> Stylized Facts</a></li>
<li class="chapter" data-level="3.10" data-path="introduction-to-financial-time-series.html"><a href="introduction-to-financial-time-series.html#references"><i class="fa fa-check"></i><b>3.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html"><i class="fa fa-check"></i><b>4</b> Introduction to ARMA-GARCH processes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#the-autocorrelation-function-acf"><i class="fa fa-check"></i><b>4.1</b> The Autocorrelation Function (ACF)</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#autoregressive-ar-processes"><i class="fa fa-check"></i><b>4.2</b> Autoregressive (AR) Processes</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#ar1-processes"><i class="fa fa-check"></i><b>4.2.1</b> AR(1) processes</a></li>
<li class="chapter" data-level="4.2.2" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#autocorrelation-function-for-ar1-processes"><i class="fa fa-check"></i><b>4.2.2</b> Autocorrelation Function for AR(1) processes</a></li>
<li class="chapter" data-level="4.2.3" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#partial-autocorrelation-functions-pacf"><i class="fa fa-check"></i><b>4.2.3</b> Partial Autocorrelation Functions (PACF)</a></li>
<li class="chapter" data-level="4.2.4" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#information-criteria"><i class="fa fa-check"></i><b>4.2.4</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#moving-average-ma-processes"><i class="fa fa-check"></i><b>4.3</b> Moving Average (MA) Processes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#autocorrelation-function"><i class="fa fa-check"></i><b>4.3.1</b> Autocorrelation Function</a></li>
<li class="chapter" data-level="4.3.2" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#illustrations"><i class="fa fa-check"></i><b>4.3.2</b> Illustrations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#autoregressive-moving-average-arma-processes"><i class="fa fa-check"></i><b>4.4</b> Autoregressive Moving Average (ARMA) Processes</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#properties"><i class="fa fa-check"></i><b>4.4.1</b> Properties</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#conditional-heteroskedasticity-models"><i class="fa fa-check"></i><b>4.5</b> Conditional Heteroskedasticity Models</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#arch-effect"><i class="fa fa-check"></i><b>4.5.1</b> ARCH Effect</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#autoregressive-conditional-heteroskedasticity-arch"><i class="fa fa-check"></i><b>4.6</b> Autoregressive Conditional Heteroskedasticity (ARCH)</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#properties-of-arch1-processes"><i class="fa fa-check"></i><b>4.6.1</b> Properties of ARCH(1) Processes</a></li>
<li class="chapter" data-level="4.6.2" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#order-determination-of-archm-processes"><i class="fa fa-check"></i><b>4.6.2</b> Order Determination of ARCH(<span class="math inline">\(m\)</span>) Processes</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#generalized-arch-garch-processes"><i class="fa fa-check"></i><b>4.7</b> Generalized ARCH (GARCH) Processes</a></li>
<li class="chapter" data-level="4.8" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#application-fitting-arma-garch-models"><i class="fa fa-check"></i><b>4.8</b> Application: Fitting ARMA GARCH Models</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#the-bombay-stock-exchange"><i class="fa fa-check"></i><b>4.8.1</b> The Bombay Stock Exchange</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="introduction-to-arma-garch-processes.html"><a href="introduction-to-arma-garch-processes.html#references-1"><i class="fa fa-check"></i><b>4.9</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Book: Statistical Finance and Computing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-arma-garch-processes" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Introduction to ARMA-GARCH processes</h1>
<div id="the-autocorrelation-function-acf" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> The Autocorrelation Function (ACF)</h2>
<p>The correlation between random variables <span class="math inline">\(X_1, X_2\)</span> is a measure of their linear dependence and is defined as:
<span class="math display">\[\rho_{12}:= \frac{\text{cov}(X_1,X_2)}{\sqrt{\text{var}(X_1)\text{var}(X_2)}}=\frac{\sigma_{12}}{\sigma_1\sigma_2}\]</span></p>
<p>It lies between -1 and 1 and for normal random variables <span class="math inline">\(\rho_{12}=0\)</span> implies that the variables are independent.</p>
<p>If we have a sample <span class="math inline">\(\{x_{1,t}, x_{2,t}\}_{t=1}^T\)</span> the correlation can be consistently estimated by computing sample correlation:
<span class="math display">\[\hat{\rho}_{12}=\frac{\hat{\sigma}_{12}}{\hat{\sigma}_1\hat{\sigma}_2}\]</span></p>
<p>For a time series <span class="math inline">\(r_t\)</span> which is weakly stationary, the lag-<span class="math inline">\(l\)</span> autocorrelation function is the correlation between <span class="math inline">\(r_t\)</span> and <span class="math inline">\(r_{t-l}\)</span>:</p>
<p><span class="math display">\[\rho_l=\frac{\sigma_{t,t-l}}{\sigma_t\sigma_{t-l}}=\frac{\sigma_{t,t-l}}{\sigma_t^2}
=\frac{\gamma_l}{\gamma_0}\]</span></p>
<p>This follows from weak stationarity: <span class="math inline">\(\sigma^2_t=\sigma^2_{t-l}=\gamma_0\)</span> and
<span class="math inline">\(\text{cov}(r_t,r_{t-l})=\gamma_l\)</span>.</p>
<p>We claim that there is no autocorrelation if <span class="math inline">\(\rho_l=0\)</span> <span class="math inline">\(\forall l&gt;0\)</span>.</p>
<p>To estimate the autocorrelation function of lag (say) 1, we use its sample counterpart:</p>
<p><span class="math display">\[\hat{\rho}_1=\frac{\sum_{t=2}^T (r_t-\bar{r})(r_{t-1}-\bar{r})}{\sum_{t=1}^T (r_t-\bar{r})^2}\]</span></p>
<p>In general for lag <span class="math inline">\(l\)</span> we consistently estimate it as:
<span class="math display">\[\hat{\rho}_l=\frac{\sum_{t=l+1}^T (r_t-\bar{r})(r_{t-1}-\bar{r})}{\sum_{t=1}^T (r_t-\bar{r})^2}\]</span></p>
<p>The statistic <span class="math inline">\(\hat{\rho_1},\hat{\rho_2},\hdots\)</span> is the <em>sample autocorrelation function</em> of <span class="math inline">\(r_t\)</span> and is key to capturing the linear dependence nature of the time series in question.</p>
</div>
<div id="autoregressive-ar-processes" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Autoregressive (AR) Processes</h2>
<p>Perhaps last period’s returns may have some significant impact on the value of the returns this period. If so, its lag-1 autocorrelation may be useful for predicting the current period’s value:</p>
<p><span class="math display">\[r_t = \phi_0+\phi_1r_{t-1}+u_t\]</span></p>
<p>where <span class="math inline">\(u_t\)</span> is weakly stationary with mean 0 and variance <span class="math inline">\(\sigma^2_u\)</span>. This is simply equivalent to a regression where <span class="math inline">\(r_{t-1}\)</span> is the explanatory or independent variable.</p>
<p>It’s straightforward to check the conditional mean and variance of such a process:</p>
<p><span class="math display">\[\mathbb{E}(r_t|r_{t-1}) = \phi_0+\phi_1r_{t-1}\]</span>
<span class="math display">\[\text{var}(r_t|r_{t-1}) = \sigma_u^2\]</span></p>
<p>And more generally there could be defined autoregressive processes of order <span class="math inline">\(p\)</span> (<span class="math inline">\(AR(p)\)</span>):</p>
<p><span class="math display">\[r_t=\phi_0+\phi_1r_{t-1}+\hdots+\phi_pr_{t-p} + u_t\]</span></p>
<div id="ar1-processes" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> AR(1) processes</h3>
<p>Is the AR(1) process <span class="math inline">\(r_t=\phi_0+\phi_1r_{t-1}+u_t\)</span> weakly stationary? This will imply that its unconditional mean and variance must be fixed in time and lag-<span class="math inline">\(l\)</span> covariance must depend only on the lag length <span class="math inline">\(l\)</span>.</p>
<p><span class="math display">\[\mathbb{E}(r_t) = \phi_0 + \phi_1\mathbb{E}(r_{t-1})+\mathbb{E}(u_t)\]</span>
<span class="math display">\[\mathbb{E}(r_t) = \phi_0 + \phi_1\mu\]</span>
<span class="math display">\[\mu = \frac{\phi_0}{1-\phi_1}\]</span></p>
<p>This clearly implies that for the mean of an AR(1) process to exist, <span class="math inline">\(\phi_1\neq 1\)</span> and <span class="math inline">\(\phi_0=\mu\cdot(1-\phi_1)=\mu-\mu\phi_1\)</span>.</p>
<p>Hence a weakly stationary AR(1) process is:
<span class="math display">\[r_t=\mu-\mu\phi_1+\phi_1r_{t-1}+u_t\]</span>
<span class="math display">\[r_t-\mu=(r_{t-1}-\mu)\phi_1+u_t\]</span>
<span class="math display">\[r_t-\mu=((r_{t-2}-\mu)\phi_2+u_{t-1})\phi_1+u_t\]</span>
<span class="math display">\[\vdots\]</span>
<span class="math display">\[r_t-\mu = u_t + \phi_1u_{t-1}+\phi_1^2u_{t-2}+\hdots\]</span>
<span class="math display">\[r_t=\mu+\sum_{i=0}^\infty\phi_1^i\cdot u_{t-i}\]</span></p>
<p>Additionally,</p>
<p><span class="math display">\[\text{var}(r_t)=\phi_1^2\text{var}(r_{t-1})+\sigma^2_u\]</span></p>
<p>Since for weakly stationary AR(1) processes <span class="math inline">\(\text{var}(r_t)=\text{var}(r_{t-1})=\gamma_0\)</span> we have
<span class="math display">\[\gamma_0 = \frac{\sigma_u^2}{1-\phi_1^2}\]</span></p>
<p>Weak stationarity immediately implies that <span class="math inline">\(\phi_1\in(-1,1)\)</span>.</p>
<p>Hence taken together, for an AR(1) process to be weakly stationary it is necessary and sufficient that <span class="math inline">\(\phi_1\in(-1,1)\)</span>;<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> and the canonical AR(1) series can be written as:
<span class="math display">\[r_t=(1-\phi_1)\mu+\phi_1r_{t-1}+u_t\]</span></p>
<p>We can plot some hypothetical autoregressive processes by simulation via the function <code>arima.sim()</code> included in the <code>stats</code> package that loads by default.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="introduction-to-arma-garch-processes.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(0)</span></span>
<span id="cb86-2"><a href="introduction-to-arma-garch-processes.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="fl">0.8</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb86-3"><a href="introduction-to-arma-garch-processes.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/arima_sim-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="introduction-to-arma-garch-processes.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(1)</span></span>
<span id="cb87-2"><a href="introduction-to-arma-garch-processes.html#cb87-2" aria-hidden="true" tabindex="-1"></a>ar_1 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.8</span>)), <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb87-3"><a href="introduction-to-arma-garch-processes.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb87-4"><a href="introduction-to-arma-garch-processes.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/arima_sim-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="introduction-to-arma-garch-processes.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(2)</span></span>
<span id="cb88-2"><a href="introduction-to-arma-garch-processes.html#cb88-2" aria-hidden="true" tabindex="-1"></a>ar_2 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.15</span>)), <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb88-3"><a href="introduction-to-arma-garch-processes.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb88-4"><a href="introduction-to-arma-garch-processes.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/arima_sim-3.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="introduction-to-arma-garch-processes.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(3)</span></span>
<span id="cb89-2"><a href="introduction-to-arma-garch-processes.html#cb89-2" aria-hidden="true" tabindex="-1"></a>ar_3 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>)), <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb89-3"><a href="introduction-to-arma-garch-processes.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ar_3, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb89-4"><a href="introduction-to-arma-garch-processes.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/arima_sim-4.png" width="336" style="display: block; margin: auto;" /></p>
</div>
<div id="autocorrelation-function-for-ar1-processes" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Autocorrelation Function for AR(1) processes</h3>
<p>We can easily check that for positive lags <span class="math inline">\(l&gt;0\)</span>, the lagged covariance follows:</p>
<p><span class="math display">\[\gamma_l = \phi_1\gamma_{l-1}\]</span></p>
<p>Hence it follows that for the autocorrelation function <span class="math inline">\(\rho_l = \phi_1\rho_{l-1}\)</span>; and because <span class="math inline">\(\rho_0=1\)</span>, <span class="math inline">\(\rho_l = \phi_1^l\)</span>. This implies that the autocorrelation function of an AR(1) series decays exponentially with rate <span class="math inline">\(\phi_1\)</span> and starting value 1. If <span class="math inline">\(\phi_1&lt;0\)</span> the series alternates between positive and negative terms.</p>
<p><strong>Illustration</strong></p>
<p>For example let’s compute the sample autocorrelation function (ACF) for the financial market indices.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="introduction-to-arma-garch-processes.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_BSE, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/sample_ACF-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="introduction-to-arma-garch-processes.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_sp500, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/sample_ACF-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="introduction-to-arma-garch-processes.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_nikkei, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/sample_ACF-3.png" width="336" style="display: block; margin: auto;" /></p>
<p>What about log-returns?</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="introduction-to-arma-garch-processes.html#cb93-1" aria-hidden="true" tabindex="-1"></a>logret_BSE <span class="ot">&lt;-</span> <span class="fu">func_pr_to_logret</span>(index_bse<span class="sc">$</span>Close)</span>
<span id="cb93-2"><a href="introduction-to-arma-garch-processes.html#cb93-2" aria-hidden="true" tabindex="-1"></a>logret_SP <span class="ot">&lt;-</span> <span class="fu">func_pr_to_logret</span>(ind_sp500<span class="sc">$</span>SP500)</span>
<span id="cb93-3"><a href="introduction-to-arma-garch-processes.html#cb93-3" aria-hidden="true" tabindex="-1"></a>logret_Nikkei <span class="ot">&lt;-</span> <span class="fu">func_pr_to_logret</span>(ind_nikkei<span class="sc">$</span>NIKKEI225)</span>
<span id="cb93-4"><a href="introduction-to-arma-garch-processes.html#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="introduction-to-arma-garch-processes.html#cb93-5" aria-hidden="true" tabindex="-1"></a>ACF_BSE <span class="ot">&lt;-</span> <span class="fu">acf</span>(logret_BSE, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/sample_ACF_logret-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="introduction-to-arma-garch-processes.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#barplot(head(ACF_BSE$acf))</span></span>
<span id="cb94-2"><a href="introduction-to-arma-garch-processes.html#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="introduction-to-arma-garch-processes.html#cb94-3" aria-hidden="true" tabindex="-1"></a>ACF_SP <span class="ot">&lt;-</span> <span class="fu">acf</span>(logret_SP, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/sample_ACF_logret-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="introduction-to-arma-garch-processes.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#barplot(head(ACF_SP$acf))</span></span>
<span id="cb95-2"><a href="introduction-to-arma-garch-processes.html#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="introduction-to-arma-garch-processes.html#cb95-3" aria-hidden="true" tabindex="-1"></a>ACF_Nikkei <span class="ot">&lt;-</span> <span class="fu">acf</span>(logret_Nikkei, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/sample_ACF_logret-3.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="introduction-to-arma-garch-processes.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#barplot(head(ACF_Nikkei$acf))</span></span></code></pre></div>
</div>
<div id="partial-autocorrelation-functions-pacf" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Partial Autocorrelation Functions (PACF)</h3>
<p>Is there a way to know how many lags to include for an autoregressive return series? This issue is solved via the usage of <em>partial autocorrelation functions</em> as shown below.</p>
<p>Consider the following sequences of AR processes:</p>
<p><span class="math display">\[r_t=\phi_{01}+ \phi_{11}r_{t-1}+u_{1t}\]</span>
<span class="math display">\[r_t=\phi_{02}+ \phi_{12}r_{t-1}+\phi_{22}r_{t-2}+u_{2t}\]</span>
<span class="math display">\[r_t=\phi_{03}+ \phi_{13}r_{t-1}+\phi_{23}r_{t-2}+\phi_{33}r_{t-3}+u_{3t}\]</span>
<span class="math display">\[r_t=\phi_{04}+ \phi_{14}r_{t-1}+\phi_{24}r_{t-2}+\phi_{34}r_{t-3}+\phi_{44}r_{t-4}+u_{4t}\]</span>
<span class="math display">\[\vdots\]</span></p>
<p>These models are merely multiple regressions and can be estimated via the standard least squares method.</p>
<p>In these models, <span class="math inline">\(\hat{\phi}_{11}\)</span> is called the lag 1 sample PACF of <span class="math inline">\(r_t\)</span>, <span class="math inline">\(\hat{\phi}_{22}\)</span> of the second equation is the lag 2 sample PACF of <span class="math inline">\(r_t\)</span> and so on. By construction, the lag 2 <span class="math inline">\(\hat{\phi}_{22}\)</span> is the marginal contribution of <span class="math inline">\(r_{t-2}\)</span> in explaining <span class="math inline">\(r_t\)</span> over the AR(1) model and so on. Hence if the underlying model is say AR(<span class="math inline">\(p\)</span>) then all sample PACFs <span class="math inline">\(\hat{\phi}_{11},\hdots, \hat{\phi}_{pp}\)</span> must be different from 0 but all sample PACFs from then on: <span class="math inline">\(\hat{\phi}_{p+1,p+1}, \hdots=0\)</span>. This property can be used to find the order <span class="math inline">\(p\)</span>.</p>
<p>Armed with this knowledge, let’s compute the PACFs for the three financial market indices:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="introduction-to-arma-garch-processes.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_BSE, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/PACF-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="introduction-to-arma-garch-processes.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_sp500, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/PACF-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="introduction-to-arma-garch-processes.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_nikkei, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/PACF-3.png" width="336" style="display: block; margin: auto;" /></p>
</div>
<div id="information-criteria" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Information Criteria</h3>
<p>Apart from PACF, another way to find the number of lags is the use of likelihood based information criteria. Here we look at the two most famous ones: the Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC).</p>
<p><span class="math display">\[\text{AIC}(l) = -\frac{2}{T}\cdot\ln(\text{likelihood})+\frac{2}{T}\cdot(\#\text{parameters})\]</span></p>
<p>For a Gaussian AR(<span class="math inline">\(l\)</span>), <span class="math inline">\(AIC=\ln(\hat{\sigma}^2_{u,MLE})+2\frac{l}{T}\)</span>. The first term measures the goodness of fit of the model while the second penalizes the usage of parameters.</p>
<p>The Bayesian Information Criterion (BIC) uses a different penalty function. For a Gaussian AR(<span class="math inline">\(l\)</span>) is takes the following form:</p>
<p><span class="math display">\[BIC(l)=\ln(\hat{\sigma}^2_{u,MLE})+\ln(T)\cdot \frac{l}{T}\]</span></p>
</div>
</div>
<div id="moving-average-ma-processes" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Moving Average (MA) Processes</h2>
<p>Consider an infinitely long autoregressive process:</p>
<p><span class="math display">\[r_t = \phi_0+\phi_1r_{t-1}+\phi_2r_{r-2}+\hdots+u_t\]</span></p>
<p>If this series is to be weakly stationary, the coefficients <span class="math inline">\(\phi_j\)</span> must decay sufficiently fast. One way to ensure this is to assume that <span class="math inline">\(\phi_j=-\theta^j\)</span> for some <span class="math inline">\(\theta\in(0,1)\)</span>.
<span class="math display">\[r_t = \phi_0-\theta_1r_{t-1}-\theta_1^2r_{t-2}-\hdots+u_t\]</span>
<span class="math display">\[r_t+\sum_{j=1}^\infty \theta_1^jr_{t-j}=\phi_0+u_t\]</span>
The same form can be written for <span class="math inline">\(r_{t-2}\)</span>:
<span class="math display">\[r_{t-1}+\sum_{j=2}^\infty \theta_1^jr_{t-j}=\phi_0+u_{t-1}\]</span></p>
<p>Solving for the above two equations, we get:
<span class="math display">\[r_t = \phi_0(1-\theta_1) + u_t -\theta_1u_{t-1}\]</span></p>
<p>This indicates the AR model is a weighted average of shocks <span class="math inline">\(u_t, u_{t-1}\)</span> and a constant. This is a <em>moving average</em> form of order 1 or MA(1). It’s straightforward to check that unlike AR processes, MA processes are <em>always</em> stationary. (Can you see why?)</p>
<p>The general form for the MA(<span class="math inline">\(q\)</span>) process is:
<span class="math display">\[r_t = c_0 + u_t -\theta_1u_{t-1}-\theta_2u_{t-2}-\hdots-\theta_qu_{t-q}\]</span></p>
<div id="autocorrelation-function" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Autocorrelation Function</h3>
<p>Consider the MA(1) model with the constant term 0:</p>
<p><span class="math display">\[r_{t} = u_t -\theta_1u_{t-1}\]</span>
<span class="math display">\[r_{t-l}r_t = u_tr_{t-l} -\theta_1u_{t-1}r_{t-l}\]</span>
<span class="math display">\[\mathbb{E}(r_{t-l}r_t)=0-\theta_1\mathbb{E}(u_{t-1}r_{t-l})\]</span>
From this we see that:
<span class="math display">\[\gamma_1=-\theta_1\sigma^2_u\]</span>
<span class="math display">\[\gamma_{l&gt;1}=0\]</span>
Also, <span class="math inline">\(\text{var}(r_t) =\gamma_0= (1+\theta_1^2)\sigma_u^2\)</span> and this implies that for <span class="math inline">\(\rho_l = \frac{\gamma_l}{\gamma_0}\)</span> becomes:
<span class="math display">\[\rho_0 = 1\]</span>
<span class="math display">\[\rho_1 = -\frac{\theta_1}{1+\theta_1^2}\]</span>
<span class="math display">\[\rho_{l&gt;1} = 0\]</span></p>
<p>Hence for MA(1) processes, while the first lag autocorrelation is nonzero, all further lags produce zero autocorrelation. This property can be exploited to locate the order of the MA process. In general, for an MA(<span class="math inline">\(q\)</span>) process, the ACF cuts off at lag <span class="math inline">\(q\)</span>. Since the MA(<span class="math inline">\(q\)</span>) process only relies on its past <span class="math inline">\(q-1\)</span> realization, it’s often called a ‘finite memory’ process.</p>
<p>To check the order of the MA series in question, we plot the ACF of the series. If <span class="math inline">\(\rho_q\neq 0\)</span> but <span class="math inline">\(\rho_{l&gt;q}=0\)</span> we may conclude that the series is MA(<span class="math inline">\(q\)</span>).</p>
</div>
<div id="illustrations" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Illustrations</h3>
<p>We simulate some moving average processes below:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="introduction-to-arma-garch-processes.html#cb100-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb100-2"><a href="introduction-to-arma-garch-processes.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="introduction-to-arma-garch-processes.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># MA(0)</span></span>
<span id="cb100-4"><a href="introduction-to-arma-garch-processes.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rnorm</span>(n), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb100-5"><a href="introduction-to-arma-garch-processes.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="introduction-to-arma-garch-processes.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MA(1)</span></span>
<span id="cb101-2"><a href="introduction-to-arma-garch-processes.html#cb101-2" aria-hidden="true" tabindex="-1"></a>ma_1 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> n, <span class="fu">list</span>(<span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.8</span>)), <span class="at">innov=</span><span class="fu">rnorm</span>(n))</span>
<span id="cb101-3"><a href="introduction-to-arma-garch-processes.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ma_1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb101-4"><a href="introduction-to-arma-garch-processes.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="introduction-to-arma-garch-processes.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ma_1)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-3.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="introduction-to-arma-garch-processes.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MA(2)</span></span>
<span id="cb103-2"><a href="introduction-to-arma-garch-processes.html#cb103-2" aria-hidden="true" tabindex="-1"></a>ma_2 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> n, <span class="fu">list</span>(<span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.15</span>)), <span class="at">innov=</span><span class="fu">rnorm</span>(n))</span>
<span id="cb103-3"><a href="introduction-to-arma-garch-processes.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ma_2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb103-4"><a href="introduction-to-arma-garch-processes.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-4.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="introduction-to-arma-garch-processes.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ma_2)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-5.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="introduction-to-arma-garch-processes.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MA(3)</span></span>
<span id="cb105-2"><a href="introduction-to-arma-garch-processes.html#cb105-2" aria-hidden="true" tabindex="-1"></a>ma_3 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> n, <span class="fu">list</span>(<span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>)), <span class="at">innov=</span><span class="fu">rnorm</span>(n))</span>
<span id="cb105-3"><a href="introduction-to-arma-garch-processes.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ma_3, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb105-4"><a href="introduction-to-arma-garch-processes.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-6.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="introduction-to-arma-garch-processes.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ma_3)</span></code></pre></div>
<p><img src="_main_files/figure-html/MA-7.png" width="336" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="autoregressive-moving-average-arma-processes" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Autoregressive Moving Average (ARMA) Processes</h2>
<p>While in principle we could fit empirical time series to AR(<span class="math inline">\(p\)</span>) or MA(<span class="math inline">\(q\)</span>) models exclusively, often the concomitant order is very high. In order to circumevent this problem, we combine AR and MA models into a composite ARMA(<span class="math inline">\(p,q\)</span>) model with fewer parameters to estimate.</p>
<p>For example the ARMA(1,1) series is as follows:
<span class="math display">\[r_t-\phi_1r_{t-1} = \phi_0 + u_t -\theta_1u_{t-1}\]</span></p>
<p>The LHS is the AR component while the RHS is MA component.</p>
<div id="properties" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Properties</h3>
<p>Taking expectations we get:
<span class="math display">\[\mathbb{E}(r_t)-\phi_1\mathbb{E}(r_{t-1}) = \phi_0 + \mathbb{E}(u_t) - \theta_1\mathbb{E}(u_{t-1})\]</span>
<span class="math display">\[\mathbb{E}(r_t) = \mu = \frac{\phi_0}{1-\phi_1}\]</span></p>
<p>This is the same exact mean as that of an AR(1) process. Solving for the stationarity of the variance we get the same condition for the parameter <span class="math inline">\(\phi_1\in (0,1)\)</span> as that of the AR(1) model. It is not hard to derive the autocorrelation function of the ARMA(1,1) process which behaves the same way as that of an AR(1) process.</p>
<p>In general for an ARMA(<span class="math inline">\(p, q\)</span>) process we have the following definition:</p>
<p><span class="math display">\[r_t = \phi_0 + \sum_{i=1}^p \phi_ir_{t-i}+u_t-\sum_{j=1}^q \theta_ju_{t-j}\]</span></p>
<p>Here are some simulations from ARMA models.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="introduction-to-arma-garch-processes.html#cb107-1" aria-hidden="true" tabindex="-1"></a>n_arma <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb107-2"><a href="introduction-to-arma-garch-processes.html#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="introduction-to-arma-garch-processes.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ARMA(1,1)</span></span>
<span id="cb107-4"><a href="introduction-to-arma-garch-processes.html#cb107-4" aria-hidden="true" tabindex="-1"></a>arma_11 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> n_arma, </span>
<span id="cb107-5"><a href="introduction-to-arma-garch-processes.html#cb107-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.5</span>)), </span>
<span id="cb107-6"><a href="introduction-to-arma-garch-processes.html#cb107-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">innov =</span> <span class="fu">rnorm</span>(n_arma)</span>
<span id="cb107-7"><a href="introduction-to-arma-garch-processes.html#cb107-7" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb107-8"><a href="introduction-to-arma-garch-processes.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(arma_11, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb107-9"><a href="introduction-to-arma-garch-processes.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span> )</span></code></pre></div>
<p><img src="_main_files/figure-html/ARMA_sim-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="introduction-to-arma-garch-processes.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ARMA(2,2)</span></span>
<span id="cb108-2"><a href="introduction-to-arma-garch-processes.html#cb108-2" aria-hidden="true" tabindex="-1"></a>arma_22 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> n_arma, </span>
<span id="cb108-3"><a href="introduction-to-arma-garch-processes.html#cb108-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>)), </span>
<span id="cb108-4"><a href="introduction-to-arma-garch-processes.html#cb108-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">innov =</span> <span class="fu">rnorm</span>(n_arma)</span>
<span id="cb108-5"><a href="introduction-to-arma-garch-processes.html#cb108-5" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb108-6"><a href="introduction-to-arma-garch-processes.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(arma_22, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb108-7"><a href="introduction-to-arma-garch-processes.html#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span> )</span></code></pre></div>
<p><img src="_main_files/figure-html/ARMA_sim-2.png" width="336" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="conditional-heteroskedasticity-models" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Conditional Heteroskedasticity Models</h2>
<p>In empirical time series, we do not observe volatility directly but only estimate it with the help of some other directly observed characteristics. However as discussed in <span class="citation">(<a href="#ref-Cont:2001" role="doc-biblioref"><strong>Cont:2001?</strong></a>)</span> volatility displays some striking regularities such as volatility clustering and differential reaction to price changes.</p>
<p>To investigate the volatility of empirical time series, we plot the daily returns and ACF of the Bombay stock exchange sensex.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="introduction-to-arma-garch-processes.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logret_BSE, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb109-2"><a href="introduction-to-arma-garch-processes.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_ret_ACF-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="introduction-to-arma-garch-processes.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">acf</span>(ret_BSE, <span class="at">na.action =</span> na.pass))</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_ret_ACF-2.png" width="336" style="display: block; margin: auto;" /></p>
<p>While there seems to be no serial autocorrelation there is some dependence structure embedded in the series. We can check this for various functions of the return process such as squared returns or absolute returns:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="introduction-to-arma-garch-processes.html#cb111-1" aria-hidden="true" tabindex="-1"></a>ret_BSE_sq <span class="ot">&lt;-</span> ret_BSE<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb111-2"><a href="introduction-to-arma-garch-processes.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_BSE_sq, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_ret_ACF_sq-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="introduction-to-arma-garch-processes.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_BSE_sq, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_ret_ACF_sq-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="introduction-to-arma-garch-processes.html#cb113-1" aria-hidden="true" tabindex="-1"></a>ret_BSE_abs <span class="ot">&lt;-</span> <span class="fu">abs</span>(ret_BSE)</span>
<span id="cb113-2"><a href="introduction-to-arma-garch-processes.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_BSE_abs, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_ret_ACF_sq-3.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="introduction-to-arma-garch-processes.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_BSE_abs, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_ret_ACF_sq-4.png" width="336" style="display: block; margin: auto;" /></p>
<p>This behavior is also displayed by the other financial markets.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="introduction-to-arma-garch-processes.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_sp500<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ret_ind_ACF_sq-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="introduction-to-arma-garch-processes.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_sp500<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ret_ind_ACF_sq-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="introduction-to-arma-garch-processes.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_nikkei<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ret_ind_ACF_sq-3.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="introduction-to-arma-garch-processes.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_nikkei<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ret_ind_ACF_sq-4.png" width="336" style="display: block; margin: auto;" /></p>
<p>The conditional mean volatility of the series may be written as:</p>
<p><span class="math display">\[\mu_t = \mathbb{E}(r_t|\mathbb{F}_{t-1})\]</span>
<span class="math display">\[\sigma_t^2 = \text{var}(r_t|\mathbb{F}_{t-1}) = \mathbb{E}((r_t-\mu_t)^2|\mathbb{F}_{t-1})
=\text{var}(u_t|\mathbb{F}_{t-1})\]</span></p>
<p>Here <span class="math inline">\(\mathbb{F}(\cdot)\)</span> denotes the ‘filtration’ or the information available at the given time.</p>
<div id="arch-effect" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> ARCH Effect</h3>
<p>Roughly speaking if the squared residuals display autocorrelation there exist ARCH effects (autoregressive conditional heteroskedasticity effects).</p>
<p>Consider <span class="math inline">\(r_t = \mu_t + u_t\)</span>. The square of the residual series <span class="math inline">\(u_t = r_t - \mu_t\)</span> is of interest for estimating conditional heteroskedasticity. A popular method of testing for ARCH effects is via the Ljung and Box statistics applied to the squared residuals series.</p>
<p>To test if autocorrelations of <span class="math inline">\(\{r_t\}\)</span> are jointly 0, the Portmanteau statistic (also called the Box-Pierce statistic) is used:
<span class="math display">\[Q^*_m = T\cdot\sum_{l=1}^m \hat{\rho}^2_l\]</span></p>
<p>The null hypothesis is <span class="math inline">\(H_0:\rho_1=\rho_2=\hdots=\rho_m=0\)</span> and the alternative is that for some <span class="math inline">\(i\)</span>, <span class="math inline">\(\rho_i\neq 0\)</span>. If <span class="math inline">\(\{r_t\}_{t=1}^T\)</span> are iid with some moment conditions, <span class="math inline">\(Q^*(m)\sim\chi^2(m)\)</span>.</p>
<p>The <em>Ljung-Box</em> test statistic is based on the Portmanteau statistic but increases its power via the following:
<span class="math display">\[Q(m)=T(T+2)\cdot\sum_{l=1}^m \frac{\hat{\rho}_l^2}{T-l}\]</span></p>
<p>We test for ARCH effects via the function <code>Box.test()</code> including in the <code>stats()</code> package</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="introduction-to-arma-garch-processes.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) <span class="co">#Benchmark squared normals</span></span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  rnorm(100)^2
## X-squared = 1.3782, df = 1, p-value = 0.2404</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="introduction-to-arma-garch-processes.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(ret_BSE_sq, <span class="at">type =</span> <span class="st">&quot;Box-Pierce&quot;</span>) <span class="co">#Squared BSE returns</span></span></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  ret_BSE_sq
## X-squared = 152.37, df = 1, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="introduction-to-arma-garch-processes.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(ret_BSE_abs, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) <span class="co">#Absolute BSE returns</span></span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  ret_BSE_abs
## X-squared = 318.58, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>The same behavior is observed for the US and Japanese market indices</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="introduction-to-arma-garch-processes.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>((ret_sp500)<span class="sc">^</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) </span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  (ret_sp500)^2
## X-squared = 115.7, df = 1, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="introduction-to-arma-garch-processes.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>((ret_nikkei)<span class="sc">^</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) </span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  (ret_nikkei)^2
## X-squared = 174.83, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Hence we may safely conclude that the market indices in question display ARCH effects—i.e., their squared residuals display autocorrelation.</p>
</div>
</div>
<div id="autoregressive-conditional-heteroskedasticity-arch" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Autoregressive Conditional Heteroskedasticity (ARCH)</h2>
<p>The essential idea behind ARCH models is that while the ‘shock’ or ‘innovation’ <span class="math inline">\(u_t\)</span> is not autocorrelated, its squared lagged terms do display autocorrelation. In other words, the ARCH(<span class="math inline">\(m\)</span>) process assumes:</p>
<p><span class="math display">\[u_t = \sigma_t\epsilon_t\]</span>
<span class="math display">\[\sigma_t^2 = \beta_0 + \beta_1u_{t-1}^2+\hdots+\beta_mu_{t-m}^2\]</span></p>
<p>Here <span class="math inline">\(\epsilon_t\)</span> is iid with mean 0 and variance 1; and all <span class="math inline">\(\beta_j\)</span> are non negative, with <span class="math inline">\(\beta_0&gt;0\)</span>. In practice it is common to assume that the shocks <span class="math inline">\(\epsilon_t\)</span> are from a standard normal, standard <span class="math inline">\(T\)</span> or some other suitable distribution. By construction, in ARCH models, large shocks tend to be followed by other large shocks.</p>
<div id="properties-of-arch1-processes" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Properties of ARCH(1) Processes</h3>
<p>Consider the ARCH(1) model:
<span class="math display">\[u_t = \sigma_t\epsilon_t\]</span>
<span class="math display">\[\sigma^2_t = \beta_0 + \beta_1u_{t-1}^2\]</span></p>
<p>Clearly the unconditional mean is <span class="math inline">\(\mathbb{E}(\mathbb{E}(u_t|\mathbb{F}_{t-1})) = 0\)</span> and the variance is <span class="math inline">\(\text{var}(u_t)=\mathbb{E}(\mathbb{E}(u^2_t|\mathbb{F}_{t-1})) = \beta_0+\beta_1\mathbb{E}(u_{t-1}^2)\)</span> and hence
<span class="math display">\[\text{var}(u_t) = \frac{\beta_0}{1-\beta_1}\]</span></p>
<p>In the same way if we compute higher moments and more specifically, the kurtosis we find that the excess kurtosis of <span class="math inline">\(u_t\)</span> is positive or in other words, for an ARCH(1) process the shocks are more fat-tailed—more likely to produce extreme values. This is consistent with empirical observations.</p>
</div>
<div id="order-determination-of-archm-processes" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Order Determination of ARCH(<span class="math inline">\(m\)</span>) Processes</h3>
<p>The ARCH(<span class="math inline">\(m\)</span>) process is:
<span class="math display">\[\sigma_t^2 = \beta_0+\beta_1u_{t-1}^2+\hdots+\beta_mu_{t-m}^2\]</span></p>
<p>Since <span class="math inline">\(u_t^2\)</span> is an unbiased estimator of <span class="math inline">\(\sigma_t^2\)</span> we can interpret the ARCH(<span class="math inline">\(m\)</span>) process as a special form of an AR(<span class="math inline">\(m\)</span>) process for square errors.</p>
<p>If ARCH effects are deemed significant, we can employ the PACFs of squared residuals to find the order of the ARCH series just as we did for AR processes.</p>
<p>Hence we apply this idea to the market indices below.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="introduction-to-arma-garch-processes.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_BSE_sq, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ARCH_order-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="introduction-to-arma-garch-processes.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>((ret_sp500)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ARCH_order-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="introduction-to-arma-garch-processes.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>((ret_nikkei)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/ARCH_order-3.png" width="336" style="display: block; margin: auto;" /></p>
<p>Depending on the distributional assumptions for <span class="math inline">\(\epsilon_t\)</span> we use different forms of the maximum likelihood estimation for estimating ARCH processes. Additionally to check if the ARCH model is well specified, we notice that <span class="math inline">\(\tilde{u}_t = \frac{u_t}{\sigma_t}\)</span> is an iid sequence.</p>
</div>
</div>
<div id="generalized-arch-garch-processes" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Generalized ARCH (GARCH) Processes</h2>
<p>Usage of GARCH models can shorten the order of the corresponding ARCH models. A GARCH(<span class="math inline">\(m,n\)</span>) process is:
<span class="math display">\[u_t = \sigma_t \epsilon_t\]</span>
<span class="math display">\[\sigma_t^2 = \alpha_0 + \sum_{i=1}^m \alpha_iu_{t-i}^2 + \sum_{j=1}^n \beta_j\sigma_{t-j}^2\]</span></p>
<p>GARCH series can be thought to be ARMA series for the squared error <span class="math inline">\(u_t^2\)</span>. GARCH models are consistent with the phenomenon of volatility clustering and thei tail distribution is fatter than that of normals.</p>
</div>
<div id="application-fitting-arma-garch-models" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Application: Fitting ARMA GARCH Models</h2>
<p>We check if the three financial market indices can be fitted satisfactorily to ARMA GARCH processes.</p>
<div id="the-bombay-stock-exchange" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> The Bombay Stock Exchange</h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="introduction-to-arma-garch-processes.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For lag order indication of MA and AR resp</span></span>
<span id="cb132-2"><a href="introduction-to-arma-garch-processes.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_BSE, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_fit_ARMA_GARCH_ACF-1.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="introduction-to-arma-garch-processes.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ret_BSE, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_fit_ARMA_GARCH_ACF-2.png" width="336" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="introduction-to-arma-garch-processes.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For lag order of ARCH and GARCH</span></span>
<span id="cb134-2"><a href="introduction-to-arma-garch-processes.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ret_BSE_sq, <span class="at">na.action =</span> na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/BSE_fit_ARMA_GARCH_ACF-3.png" width="336" style="display: block; margin: auto;" /></p>
<p>We will use two main functions for estimating such models. One is the function <code>tseries::garch()</code> which may be used for relatively simple fittings and the other are sets of functions from the package <code>rugarch</code> which offers more options including a diverse set of distributions for the innovations.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="introduction-to-arma-garch-processes.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify an ARMA(1,1) GARCH(1,1) model</span></span>
<span id="cb135-2"><a href="introduction-to-arma-garch-processes.html#cb135-2" aria-hidden="true" tabindex="-1"></a>spec_garch_BSE <span class="ot">&lt;-</span> rugarch<span class="sc">::</span><span class="fu">ugarchspec</span>() <span class="co">#empty specification</span></span>
<span id="cb135-3"><a href="introduction-to-arma-garch-processes.html#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="introduction-to-arma-garch-processes.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate it</span></span>
<span id="cb135-5"><a href="introduction-to-arma-garch-processes.html#cb135-5" aria-hidden="true" tabindex="-1"></a>est_garch_BSE <span class="ot">&lt;-</span> rugarch<span class="sc">::</span><span class="fu">ugarchfit</span>(<span class="at">data =</span> <span class="sc">!</span><span class="fu">is.na</span>(ret_BSE), <span class="co">#note</span></span>
<span id="cb135-6"><a href="introduction-to-arma-garch-processes.html#cb135-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">spec =</span> spec_garch_BSE</span>
<span id="cb135-7"><a href="introduction-to-arma-garch-processes.html#cb135-7" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb135-8"><a href="introduction-to-arma-garch-processes.html#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="introduction-to-arma-garch-processes.html#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(est_garch_BSE)</span></code></pre></div>
<pre><code>## 
## *---------------------------------*
## *          GARCH Model Fit        *
## *---------------------------------*
## 
## Conditional Variance Dynamics    
## -----------------------------------
## GARCH Model  : sGARCH(1,1)
## Mean Model   : ARFIMA(1,0,1)
## Distribution : norm 
## 
## Optimal Parameters
## ------------------------------------
##         Estimate  Std. Error    t value Pr(&gt;|t|)
## mu       1.00000    0.000069 14564.3352 0.000000
## ar1      0.00000    0.141076     0.0000 1.000000
## ma1      0.24873    0.160545     1.5493 0.121319
## omega    0.00000    0.000000     4.6840 0.000003
## alpha1   0.05000    0.009125     5.4792 0.000000
## beta1    0.90000    0.001924   467.7716 0.000000
## 
## Robust Standard Errors:
##         Estimate  Std. Error    t value Pr(&gt;|t|)
## mu       1.00000    0.000095 10551.5613  0.00000
## ar1      0.00000    0.339224     0.0000  1.00000
## ma1      0.24873    0.185917     1.3378  0.18095
## omega    0.00000    0.000000     1.3490  0.17734
## alpha1   0.05000    0.005717     8.7463  0.00000
## beta1    0.90000    0.003441   261.5554  0.00000
## 
## LogLikelihood : 24036.84 
## 
## Information Criteria
## ------------------------------------
##                     
## Akaike       -11.006
## Bayes        -10.997
## Shibata      -11.006
## Hannan-Quinn -11.003
## 
## Weighted Ljung-Box Test on Standardized Residuals
## ------------------------------------
##                         statistic p-value
## Lag[1]                      1.325  0.2497
## Lag[2*(p+q)+(p+q)-1][5]     1.397  0.9992
## Lag[4*(p+q)+(p+q)-1][9]     1.406  0.9980
## d.o.f=2
## H0 : No serial correlation
## 
## Weighted Ljung-Box Test on Standardized Squared Residuals
## ------------------------------------
##                         statistic p-value
## Lag[1]                  0.0003950  0.9841
## Lag[2*(p+q)+(p+q)-1][5] 0.0003963  1.0000
## Lag[4*(p+q)+(p+q)-1][9] 0.0003964  1.0000
## d.o.f=2
## 
## Weighted ARCH LM Tests
## ------------------------------------
##             Statistic Shape Scale P-Value
## ARCH Lag[3] 5.943e-09 0.500 2.000  0.9999
## ARCH Lag[5] 6.164e-09 1.440 1.667  1.0000
## ARCH Lag[7] 6.700e-09 2.315 1.543  1.0000
## 
## Nyblom stability test
## ------------------------------------
## Joint Statistic:  -1907.443
## Individual Statistics:              
## mu      701.24
## ar1      31.71
## ma1      34.82
## omega  1367.22
## alpha1  103.39
## beta1  1151.78
## 
## Asymptotic Critical Values (10% 5% 1%)
## Joint Statistic:          1.49 1.68 2.12
## Individual Statistic:     0.35 0.47 0.75
## 
## Sign Bias Test
## ------------------------------------
##                      t-value       prob sig
## Sign Bias          3.366e+01 5.475e-221 ***
## Negative Sign Bias 1.172e+03  0.000e+00 ***
## Positive Sign Bias 8.267e+01  0.000e+00 ***
## Joint Effect       1.659e+06  0.000e+00 ***
## 
## 
## Adjusted Pearson Goodness-of-Fit Test:
## ------------------------------------
##   group statistic p-value(g-1)
## 1    20     82257            0
## 2    30    125641            0
## 3    40    169128            0
## 4    50    212660            0
## 
## 
## Elapsed time : 0.220928</code></pre>
<!-- We can also fit standard $T$ innovations instead of normal innovations: -->
<!-- ```{r BSE_fit_ARMA_GARCH_T} -->
<!-- # Specify an ARMA(1,1) GARCH model with T innovations.  -->
<!-- spec_garch_BSE_T <- rugarch::ugarchspec(variance.model=list(model="sGARCH"), -->
<!--                                         mean.model =  -->
<!--                                       distribution.model = "std" -->
<!--                                       ) -->
<!-- # Estimate it -->
<!-- est_garch_BSE_T <- rugarch::ugarchfit(data = !is.na(ret_BSE), -->
<!--                                     spec = spec_garch_BSE_T -->
<!--                                     ) -->
<!-- show(est_garch_BSE) -->
<!-- ``` -->
</div>
</div>
<div id="references-1" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> References</h2>

</div>
</div>







<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>For a general AR(<span class="math inline">\(p\)</span>) process, the corresponding condition is: <span class="math inline">\(|\phi_1|+|\phi_2|+\hdots+|\phi_p|&lt;1\)</span>.<a href="introduction-to-arma-garch-processes.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-financial-time-series.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/11-intro_arma_garch.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
